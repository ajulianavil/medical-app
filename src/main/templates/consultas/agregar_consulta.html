{% extends 'main/layout.html' %}
{% load static %}
{% block head %}
    <link rel="stylesheet" type="text/css" href="{% static 'css/main.css' %}"/>
    <link rel="stylesheet" type="text/css" href="{% static 'css/main_fonts.css' %}"/>
    <link rel="stylesheet" type="text/css" href="{% static 'css/upload_file.css' %}"/>

    <script src="https://kit.fontawesome.com/5bdb3c603b.js" crossorigin="anonymous"></script>
    <script src="{% static 'js/upload_file.js' %}"></script>

{% endblock %}

{% block content %}

    {% if messages %}
    {% for message in messages %}
        <div class="alert alert-danger">
            {{ message }}
        </div> 
    {% endfor %}
{% endif %}
<div style="    text-align: center;
padding: 50px;">
</br>
    <h1 style="font-weight: bold; color: #0796D8">Nueva consulta</h1>
    <h5 style="font-weight: bold; color: #26283E"> {% if multiple %} Embarazo múltiple {%else%} Embarazo de feto único {%endif%}</h5>
    </br>
    <div style="display: flex; justify-content: space-around;
    align-items: center;">
    <div class="bg-light p-5 text-center" style="border-radius: 15px; width: 60%">

    {% comment %} <p style="font-weight: lighter; color: #909090; margin-bottom: 0px">{% if multiple %} Sus archivos se procesarán para generar los reporte de diagnóstico de cada feto. {%else%}Su archivo se procesará para generar el reporte de diagnóstico. {%endif%}</p> {% endcomment %}
    
    </p>

    <form method="POST", enctype="multipart/form-data">
        {% csrf_token %}
        {% comment %} <input type="file" name="file" id="file" /> {% endcomment %}
        <div class="drop_box">
            <header>
            <h4>{% if multiple %} Por favor, cargue un archivo por cada feto. {%else%}Por favor, cargue el archivo extraído del ultrasonido.</h4> {%endif%} 

            <p style="font-weight: lighter; color: #909090; margin-top:10px">Asegúrese de que el archivo no haya sido manipulado previamente.</p>
            </header>
            <p>Archivos soportados: TEXT</p>
            <div class="inputContainer" id="inputContainer">
                {% if multiple %}
                <div class="mid-container">
                    <div class="left-div" id="left-div">
                        <input type="file" accept="text/plain" name="file1" id="file1">
                        
                        <input type="file" accept="text/plain" name="file2" id="file2">
                        {% comment %} <button class="btn" type="button" onclick="addInput()" style="width: 80%"><i class="fa-solid fa-plus" style="margin-right: 5px"></i> Añadir otro archivo</button> {% endcomment %}
                    </div>
                    <div class="right-div">
                        <i class="fa-solid fa-file-circle-plus add-file" onclick="addInput()"></i>
                    </div>
                </div>
                {%else%}
                    <input type="file" accept="text/plain" name="file1" id="file1">
                {% endif %}
            </div>
            <br/>
          </div>
        <br>
        <br>
        <button class="btn submit-button" type="submit">Procesar</button>
    </form>

  </div>
</div>
</div>

<script>
    function addInput() {
        var inputContainer = document.getElementById("left-div");
        var inputCount = inputContainer.getElementsByTagName("input").length;
        console.log(inputCount)
        var newInput = document.createElement("input");
        newInput.type = "file";
        newInput.accept = "text/plain";
        newInput.name = "file" + (inputCount + 1);
        newInput.id = "file" + (inputCount + 1);
        if (inputCount < 5) {
            inputContainer.appendChild(newInput);
        }
    }
</script>
{% endblock %}
